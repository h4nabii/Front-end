<!doctype html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>

        .main {
            width: 1000px;
            margin: 0 auto;
        }

        .control-bar {
            height: 200px;
            line-height: 200px;
            display: flex;
            flex-direction: row;
        }

        .control-bar #control-add {
            display: block;
            width: 200px;
            height: inherit;
        }

        .control-bar #control-bin {
            background-color: skyblue;
            flex-grow: 1;
            text-align: center;
        }

        .container {
            display: flex;
            flex-flow: row wrap;
        }

        .container .item {
            height: 180px;
            width: 180px;
            margin: 10px;
            background-color: pink;
        }
    </style>
</head>
<body>
<div class="main">
    <div class="control-bar">
        <button id="control-add">ADD</button>
        <div id="control-bin">Drag to Delete</div>
    </div>
    <div class="container" id="container">
        <!--        <div class="item" draggable="true"></div>-->
    </div>
</div>
<script>
    let nextID = 0;

    function createItem() {
        let item = document.createElement("div");
        item.className = "item";
        item.setAttribute("draggable", "true");
        item.dataset.id = (++nextID).toString();
        item.textContent = item.dataset.id;
        item.ondragstart = function (ev) {
            // console.log(1);
            ev.dataTransfer.setData("application/json", JSON.stringify({
                id: item.dataset.id,
                name: 10
            }));
        };
        return item;
    }

    let oCon = document.getElementById("container"); // reference
    let oBtn = document.querySelector("#control-add"); // copy
    oBtn.onclick = function () {
        let oItem = createItem();
        oCon.appendChild(oItem);
    };

    let oBin = document.querySelector("#control-bin");
    oBin.ondragover = function (ev) {
        ev.preventDefault(); // 阻止默认的“阻止拖放”行为
        // console.log("DragOver");
    };

    oBin.ondrop = function (ev) {
        ev.preventDefault();
        // console.log("Drop");
        // console.log(ev.dataTransfer.getData("text/plain"));
        // console.log(ev.dataTransfer.getData("application/json"));
        // console.log(ev.dataTransfer.types);
        let {id} = JSON.parse(ev.dataTransfer.getData("application/json"));
        console.log(id);
        for (let i = 0; i < oCon.children.length; i++) {
            if (id === oCon.children[i].dataset.id) {
                oCon.removeChild(oCon.children[i]);
                break;
            }
        }
    };

    // document.addEventListener("keyup", function (ev) {
    //     console.log(ev.code);
    // });
</script>
</body>
</html>
